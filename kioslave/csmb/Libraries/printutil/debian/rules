#!/usr/bin/make -f
# Made with the aid of debmake, by Christoph Lameter,
# games on the sample debian/rules file for GNU hello by Ian Jackson.

BUILDDIR = ./build

build: build-stamp

-include debian/debiandirs

debian/debiandirs: admin/debianrules
	perl -w admin/debianrules echodirs > debian/debiandirs

build-stamp:
	dh_testdir
	if test ! -f configure; then \
	  $(MAKE) -f admin/Makefile.common ;\
	fi 
	./configure $(configkde)

	make

	touch build-stamp

clean: debian-clean
	dh_clean

debian-clean:
	dh_testdir
	-rm -f debian/debiandirs
	if test -d CVS; then \
	  make -f admin/Makefile.common cvs-clean ;\
	fi
	-make distclean

binary-indep:	build
	dh_testroot
	dh_testdir
# There are no architecture-independent files to be uploaded
# generated by this package.  If there were any they would be
# made here.

binary-arch: build
	dh_testdir
	dh_testroot
	dh_clean -k
	install -d debian/tmp/etc/kde2
	make DESTDIR=`pwd`/debian/tmp/ install
	perl -w admin/debianrules cleanup
	dh_undocumented
	dh_movefiles -pcorel-libccui
	#
	#Copy files for libusermang
	dh_movefiles -pcorel-libusermgr usr/lib/libusermang.la \
		usr/lib/libusermang.so.1.0.0 \
		usr/lib/libusermang.so.1 \
		usr/lib/libusermang.so \
		usr/include/usermang.h
	#
	#Copy files for printutil
	dh_movefiles -pcorel-libprintutil usr/lib/libprintutil.so.1.0.0 \
		usr/lib/libprintutil.la \
		usr/lib/libprintutil.so.1 \
		usr/lib/libprintutil.so
	#
	#Copy files for mwn
	dh_movefiles -pcorel-libmwn usr/lib/libmwn.so.2.0.0 \
		usr/lib/libmwn.la \
		usr/lib/libmwn.so.2 \
		usr/lib/libmwn.so
	#
	#Copy files for libpropdlg
	dh_movefiles -pcorel-libpropdlg usr/lib/libpropdlg.so.2.0.0 \
		usr/lib/libpropdlg.la \
		usr/lib/libpropdlg.so.2 \
		usr/lib/libpropdlg.so
	#
	#Copy files for corel-explorer
	dh_movefiles -pcorel-explorer usr/bin/CorelExplorer \
		usr/bin/netserv \
		usr/bin/CopyAgent \
		usr/bin/FtpAgent
#		usr/share/icons/mini/CorelExplorer.xpm \
#		usr/share/apps/CorelExplorer/cfm.exclude \
	#
	#Copy files for videosettings
	dh_movefiles -pcorel-videosettings usr/share/icons/hicolor/32x32/apps/video_setting.png \
		usr/share/icons/locolor/32x32/apps/video_setting.png \
		usr/share/icons/locolor/16x16/apps/video_setting.png \
		usr/share/apps/kcontrol/pics/256.png \
		usr/share/apps/kcontrol/pics/thousand.png \
		usr/share/apps/kcontrol/pics/million.png \
		usr/lib/libkcm_videosetting.so \
		usr/lib/libkcm_videosetting.la \
		usr/share/applnk/Settings/LookNFeel/video_setting.desktop
	#
	#Copy files for knetconfig
	dh_movefiles -pcorel-netconfig usr/lib/libkcm_knetconfig.so \
		usr/lib/libkcm_knetconfig.la \
		usr/share/icons/hicolor/32x32/apps/knetconfig.png \
		usr/share/icons/locolor/32x32/apps/knetconfig.png \
		usr/share/icons/locolor/16x16/apps/knetoconfig.png \
		usr/share/applnk/Settings/Network/knetconfig.desktop
	#
	#Copy files for pkusbview
	dh_movefiles -pcorel-usbviewer usr/share/icons/hicolor/32x32/apps/usbview.png \
		usr/share/icons/locolor/32x32/apps/usbview.png \
		usr/share/icons/locolor/16x16/apps/usbview.png \
		usr/share/apps/kcontrol/pics/USB_in.png \
		usr/share/apps/kcontrol/pics/USB_in_out.png \
		usr/share/apps/kcontrol/pics/USB_out.png \
		usr/share/apps/kcontrol/pics/USB_root_hub.png \
		usr/lib/libkcm_kusbview.so \
		usr/lib/libkcm_kusbview.la \
		usr/share/applnk/Settings/Information/kusbview.desktop
	#
	#Copy files for regionalsettings
	dh_movefiles -pcorel-regionalsettings usr/bin/localeoutput \
		usr/lib/libkcm_rscp.so \
		usr/lib/libkcm_rscp.la \
		usr/share/applnk/Settings/Personalization/rscp.desktop \
		etc/kde2/rscprc \
		usr/share/icons/rscp.xpm \
		usr/share/apps/rscp/rscp_worldmap.xpm \
		usr/share/icons/rscp_up_arrow.xpm \
		usr/share/icons/rscp_down_arrow.xpm
	#
	#Copy files for hwcontrolpanel
	dh_movefiles -pcorel-hardwarepanel usr/lib/libkcm_kcmhardwarepanel.so \
		usr/lib/libkcm_kcmhardwarepanel.la \
		usr/share/applnk/Settings/Network/hwcontrolpanel.desktop \
		usr/bin/devicesupdate \
		etc/init.d/devicesupdate.sh
	#
	#Copy files for eventview
	dh_movefiles -pcorel-eventviewer usr/share/doc/kde/HTML/en/eventview/index.html \
		usr/bin/eventview \
		usr/bin/log_clean \
		root/.kde/share/applnk/Applications/System/eventview.kdelnk
	#
	#Copy files for corel-Update
	dh_movefiles -pcorel-update usr/bin/get_it \
		usr/share/applnk/Applications/System/corelupdate.desktop \
		usr/share/apps/get_it/html/getit_backgrnd.jpg \
		usr/share/apps/get_it/html/linux.gif \
		usr/share/apps/get_it/html/latestlinux.gif \
		usr/share/apps/get_it/html/largebanner.html \
		usr/share/apps/get_it/html/Box.gif \
		usr/share/apps/get_it/html/depackage.gif \
		etc/kde2/get_itrc \
		usr/share/icons/get_it.xpm \
		usr/bin/rpmtodeb
	#
	#Copy files for kdn
	dh_movefiles -pcorel-kdm \
		lib/security/pam_smb_auth.so \
		usr/share/apps/kdm/pics/kdelogo.xpm \
		usr/share/apps/kdm/pics/kdeflower.xpm \
		usr/share/apps/kdm/pics/users/default.xpm \
		usr/share/apps/kdm/pics/users/default2.xpm \
		usr/share/apps/kdm/pics/users/root.xpm \
		usr/share/apps/kdm/pics/users/root2.xpm \
		etc/kde2/kdmrc \
		usr/X11R6/lib/X11/xdm/Xservers.ws \
		usr/X11R6/lib/X11/xdm/xdm-config \
		usr/X11R6/lib/X11/xdm/Xservers \
		usr/X11R6/lib/X11/xdm/xdm-config \
		usr/X11R6/lib/X11/xdm/Xresources \
		usr/X11R6/lib/X11/xdm/Xservers \
		usr/X11R6/lib/X11/xdm/Xaccess \
		usr/X11R6/lib/X11/xdm/Xsession \
		usr/X11R6/lib/X11/xdm/GiveConsole \
		usr/X11R6/lib/X11/xdm/TakeConsole \
		usr/X11R6/lib/X11/xdm/Xsetup_0 \
		usr/X11R6/lib/X11/xdm/Xmodmap \
		usr/bin/kdmkbd \
		usr/bin/kdm
	#
	#
	dh_installdocs
	dh_installmenu
	dh_installchangelogs
	dh_strip
	dh_perl
	dh_compress
	#dh_fixperms
	dh_suidregister
	dh_installdeb
	#dh_shlibdeps
	dh_gencontrol
	dh_md5sums
	dh_builddeb            

# Below here is fairly generic really

binary:		binary-indep binary-arch

.PHONY: binary binary-arch binary-indep clean
